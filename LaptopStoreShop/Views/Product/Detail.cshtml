@{
    ViewData["Title"] = "Product Detail";
}
@model LaptopStoreShop.Models.Laptop

@if (TempData["Success"] != null)
{
	<div class="alert alert-success alert-dismissible fade show" role="alert">
		@TempData["Success"]
		<button type="button" class="btn-close" data-bs-dismiss="alert"></button>
	</div>
}

@if (TempData["Message"] != null)
{
	<div class="alert alert-danger alert-dismissible fade show" role="alert">
		@TempData["Message"]
		<button type="button" class="btn-close" data-bs-dismiss="alert"></button>
	</div>
}

<div class="section">
	<div class="container">
		<div class="row">
			<div class="col-md-5 col-md-push-2">
				<div id="product-main-img">
					@foreach (var img in Model.LaptopImages)
					{
						<div class="product-preview">
							<img src="@img.ImageUrl" alt="@Model.Name">
						</div>
					}
				</div>
			</div>
			<div class="col-md-2  col-md-pull-5">
				<div id="product-imgs">
					@foreach (var img in Model.LaptopImages)
					{
						<div class="product-preview">
							<img src="@img.ImageUrl" alt="@Model.Name">
						</div>
					}
					
				</div>
			</div>
			<div class="col-md-5">
				<div class="product-details">
					<h2 class="product-name">@Model.Name</h2>
					<div>
						<div class="product-rating">
							<i class="fa fa-star"></i>
							<i class="fa fa-star"></i>
							<i class="fa fa-star"></i>
							<i class="fa fa-star"></i>
							<i class="fa fa-star-o"></i>
						</div>
					</div>
					<div>
						<h3 class="product-price">@Model.Price VNĐ</h3>
						<span class="product-available">Trong kho:</span> @Model.Stock
					</div>
					<div class="add-to-cart d-flex">
						<div class="qty-label">
							Số lượng
							<div class="input-number">
								<input type="number" value=1 min=1 max=@Model.Stock>
								<span class="qty-up">+</span>
								<span class="qty-down">-</span>
							</div>
						</div>

						<form id="addToCartForm" asp-controller="Payment" asp-action="AddToCart" method="post" style="padding-top: 15px;">
							<input type="hidden" name="id" value="@Model.Id">
							<input type="hidden" name="name" value="@Model.Name">
							<input type="hidden" name="price" value="@Model.Price">
							<input type="hidden" name="stock" value="@Model.Stock">
							<input type="hidden" name="imageUrl" value="@Model.LaptopImages.FirstOrDefault()?.ImageUrl">
							<input type="hidden" id="qtyHidden" name="qty" value="1">

							<button type="submit" class="add-to-cart-btn">
								<i class="fa fa-shopping-cart"></i> Thêm giỏ hàng
							</button>
						</form>
					</div>
					<ul class="product-links">
						<li>Loại:</li>
						<li><a href="#">@Model.Category.CategoryName</a></li>
						<li>Hãng:</li>
						<li><a href="#">@Model.Brand.BrandName</a></li>
					</ul>

					<ul class="product-links">
						<li>Share:</li>
						<li><a href="#"><i class="fa fa-facebook"></i></a></li>
						<li><a href="#"><i class="fa fa-twitter"></i></a></li>
						<li><a href="#"><i class="fa fa-google-plus"></i></a></li>
						<li><a href="#"><i class="fa fa-envelope"></i></a></li>
					</ul>

				</div>
			</div>
			<!-- /Product details -->
			<!-- Product tab -->
			<div class="col-md-12">
				<div id="product-tab">
					<!-- product tab nav -->
					<ul class="tab-nav">
						<li class="active"><a data-toggle="tab" href="#tab1">Thông số chi tiết</a></li>
						
					</ul>
					<!-- /product tab nav -->
					<!-- product tab content -->
					<div class="tab-content">
						<div id="tab1" class="tab-pane fade in active">
							<div class="row">
								<div class="col-md-12">
									<p>@Model.Description</p>
								</div>
							</div>
						</div>
					</div>
					<!-- /product tab content  -->
				</div>
			</div>
			<!-- /product tab -->
		</div>
		<!-- /row -->
	</div>
	<!-- /container -->
</div>
<!-- /SECTION -->
<script>

	document.addEventListener("DOMContentLoaded", function () {
		const qtyInput = document.getElementById("qtyInput");
		const addToCartBtn = document.getElementById("addToCartBtn");

		qtyInput.addEventListener("input", function () {
			let qty = qtyInput.value;
			let newUrl = addToCartBtn.href.replace(/qty=\d+/, `qty=${qty}`);
			addToCartBtn.href = newUrl;
		});
	});
</script>